```python
'''
input_solver - defines mesh and solves poisson eqaution
'''
import numpy as np
from input_solver import *

T = 300 # K
k = 11.8
Nc = 2.8e19 # /cm^3
Nv = 1.04e19 # /cm^3
Eg = 1.1
mu_n = 1000 # cm^2/V-s
mu_p = 500 # cm^2/V-s
tn = 1000 # us
tp = 1000 # us
affinity = 1 # eV

params = [T,k,Nc,Nv,Eg,mu_n,mu_p,tn,tp,affinity]
```


```python
'''
Define doping profile 
Unit of x is microns.
Unit of doping is per cubic centimeter
'''
def doping(x): 
    if(x<5):
        return -1e18
    elif(x>=95):
        return 1e18
    else:
        return 1e12

''' 
Define node positions and mesh spacing about them as [node position,spacing]
Length unit : microns
'''
nodes = [[0,0.5],[5,0.01],[50,1],[95,0.01 ],[100,0.5]]  

'''
Define left and right boundary conditions as [contact_type,value] where value is potential offset for ohmic and schottky contacts and electric field for normal derivative boundary conditionsplotter.plot_1d(x,V,'Potential','volt')
plotter.plot_1d(x,n,'Electron density','density',scale='logy')
plotter.plot_1d(x,p,'Hole density','density',scale='logy')
plotter.plot_1d(x,n+p,'Total carrier density','density',scale='logy')
'o' - ohmic
's' - schottky
'n' - normal electric field
Potential unit - Volts
Electric field unit - Volts/micron
'''
boundary = [['o',0],['o',0]]

mesh,Nd,V,n,p = solution_eq_1d(params,nodes,doping,boundary,geom='rect')

plot_solution_1d(mesh,Nd,V,n,p,params,show=True)
```

    Rectangular structure
    Total number of nodes = 495
    
    Maximum net doping = 1.000000E+18 /cm³
    Minimum net doping = -1.000000E+18 /cm³
    Minimum absolute doping = 1.000000E+12 /cm³
    
    Solution converged
    
    Writing mesh and solution to solution.out



    
![png](solver_files/solver_1_1.png)
    



    
![png](solver_files/solver_1_2.png)
    



    
![png](solver_files/solver_1_3.png)
    



    
![png](solver_files/solver_1_4.png)
    



    
![png](solver_files/solver_1_5.png)
    



    
![png](solver_files/solver_1_6.png)
    



```python
contact = [['o',0],['o',0]]  # set boundary condition at contacts. Unit of potential is volt

def gen(x): # define carrier generation rate by physical process other than thermal generation (Unit : per cubic centimeter per second)
    return 0
    
bias = [-5,1] # Voltage bias sweep (Reverse bias and forward bias) to be applied on left end with respect to right end. Unit of voltage is volt

mesh,Nd,solution_start,solution_end,V,J,J_left,J_right = solve_current(params,nodes,doping,contact,bias)

plot_JV(V,J,params,show=False)

plot_solution_both_ends(mesh,Nd,params,solution_start,solution_end,show=False)
```

    Rectangular structure
    Total number of nodes = 495
    
    Maximum net doping = 1.000000E+18 /cm³
    Minimum net doping = -1.000000E+18 /cm³
    Minimum absolute doping = 1.000000E+12 /cm³
    
    Generation source current = 0.000E+00 A/cm²
    
    V(Volts)	J_left(A/cm²)		J_right(A/cm²)		J(A/cm²)
    		Jn	Jp		Jn	Jp
    ---------------------------------------------------------------------------
    0.000		0.000E+00 0.000E+00	0.000E+00 0.000E+00	0.000E+00
    -0.026		-5.056E-13 -2.718E-10	-2.723E-10 -2.519E-13	-2.724E-10
    -0.052		-6.922E-13 -4.384E-10	-4.385E-10 -3.449E-13	-4.390E-10
    -0.077		-7.610E-13 -5.565E-10	-5.569E-10 -3.792E-13	-5.573E-10
    -0.103		-7.864E-13 -6.509E-10	-6.510E-10 -3.919E-13	-6.515E-10
    -0.129		-7.958E-13 -7.327E-10	-7.331E-10 -3.966E-13	-7.335E-10
    -0.155		-7.993E-13 -8.076E-10	-8.081E-10 -3.983E-13	-8.085E-10
    -0.180		-8.006E-13 -8.777E-10	-8.778E-10 -3.990E-13	-8.783E-10
    -0.206		-8.010E-13 -9.437E-10	-9.442E-10 -3.992E-13	-9.445E-10
    -0.232		-8.012E-13 -1.007E-09	-1.008E-09 -3.993E-13	-1.008E-09
    -0.258		-8.013E-13 -1.068E-09	-1.069E-09 -3.993E-13	-1.069E-09
    -0.284		-8.013E-13 -1.127E-09	-1.127E-09 -3.994E-13	-1.128E-09
    -0.309		-8.013E-13 -1.184E-09	-1.184E-09 -3.994E-13	-1.185E-09
    -0.335		-8.013E-13 -1.239E-09	-1.239E-09 -3.994E-13	-1.240E-09
    -0.361		-8.013E-13 -1.292E-09	-1.292E-09 -3.994E-13	-1.293E-09
    -0.387		-8.013E-13 -1.344E-09	-1.344E-09 -3.994E-13	-1.345E-09
    -0.412		-8.013E-13 -1.394E-09	-1.395E-09 -3.994E-13	-1.395E-09
    -0.438		-8.013E-13 -1.444E-09	-1.444E-09 -3.994E-13	-1.445E-09
    -0.464		-8.013E-13 -1.492E-09	-1.493E-09 -3.994E-13	-1.493E-09
    -0.490		-8.013E-13 -1.539E-09	-1.540E-09 -3.994E-13	-1.540E-09
    -0.515		-8.013E-13 -1.585E-09	-1.586E-09 -3.994E-13	-1.586E-09
    -0.541		-8.013E-13 -1.630E-09	-1.631E-09 -3.995E-13	-1.631E-09
    -0.567		-8.013E-13 -1.674E-09	-1.675E-09 -3.995E-13	-1.675E-09
    -0.593		-8.013E-13 -1.718E-09	-1.718E-09 -3.995E-13	-1.719E-09
    -0.619		-8.013E-13 -1.761E-09	-1.761E-09 -3.995E-13	-1.761E-09
    -0.644		-8.013E-13 -1.802E-09	-1.803E-09 -3.995E-13	-1.803E-09
    -0.670		-8.013E-13 -1.844E-09	-1.844E-09 -3.995E-13	-1.844E-09
    -0.696		-8.013E-13 -1.884E-09	-1.885E-09 -3.995E-13	-1.885E-09
    -0.722		-8.013E-13 -1.924E-09	-1.924E-09 -3.995E-13	-1.924E-09
    -0.747		-8.013E-13 -1.963E-09	-1.963E-09 -3.995E-13	-1.964E-09
    -0.773		-8.013E-13 -2.002E-09	-2.002E-09 -3.995E-13	-2.002E-09
    -0.799		-8.013E-13 -2.040E-09	-2.040E-09 -3.995E-13	-2.040E-09
    -0.825		-8.013E-13 -2.077E-09	-2.077E-09 -3.995E-13	-2.078E-09
    -0.851		-8.013E-13 -2.114E-09	-2.115E-09 -3.995E-13	-2.115E-09
    -0.876		-8.013E-13 -2.151E-09	-2.151E-09 -3.995E-13	-2.152E-09
    -0.902		-8.013E-13 -2.187E-09	-2.187E-09 -3.995E-13	-2.187E-09
    -0.928		-8.013E-13 -2.222E-09	-2.222E-09 -3.996E-13	-2.223E-09
    -0.954		-8.013E-13 -2.257E-09	-2.258E-09 -3.996E-13	-2.258E-09
    -0.979		-8.013E-13 -2.292E-09	-2.292E-09 -3.996E-13	-2.293E-09
    -1.005		-8.013E-13 -2.326E-09	-2.327E-09 -3.996E-13	-2.327E-09
    -1.031		-8.013E-13 -2.360E-09	-2.360E-09 -3.996E-13	-2.361E-09
    -1.057		-8.013E-13 -2.394E-09	-2.394E-09 -3.996E-13	-2.395E-09
    -1.082		-8.013E-13 -2.427E-09	-2.427E-09 -3.996E-13	-2.427E-09
    -1.108		-8.013E-13 -2.460E-09	-2.460E-09 -3.996E-13	-2.460E-09
    -1.134		-8.013E-13 -2.492E-09	-2.493E-09 -3.996E-13	-2.493E-09
    -1.160		-8.013E-13 -2.524E-09	-2.525E-09 -3.996E-13	-2.525E-09
    -1.186		-8.013E-13 -2.556E-09	-2.556E-09 -3.996E-13	-2.557E-09
    -1.211		-8.013E-13 -2.587E-09	-2.588E-09 -3.996E-13	-2.588E-09
    -1.237		-8.013E-13 -2.619E-09	-2.619E-09 -3.996E-13	-2.619E-09
    -1.263		-8.013E-13 -2.649E-09	-2.650E-09 -3.996E-13	-2.650E-09
    -1.289		-8.013E-13 -2.680E-09	-2.680E-09 -3.996E-13	-2.681E-09
    -1.314		-8.013E-13 -2.710E-09	-2.710E-09 -3.996E-13	-2.711E-09
    -1.340		-8.013E-13 -2.740E-09	-2.740E-09 -3.996E-13	-2.741E-09
    -1.366		-8.013E-13 -2.770E-09	-2.770E-09 -3.996E-13	-2.771E-09
    -1.392		-8.013E-13 -2.799E-09	-2.800E-09 -3.996E-13	-2.800E-09
    -1.418		-8.013E-13 -2.829E-09	-2.829E-09 -3.996E-13	-2.830E-09
    -1.443		-8.013E-13 -2.858E-09	-2.858E-09 -3.996E-13	-2.859E-09
    -1.469		-8.013E-13 -2.886E-09	-2.887E-09 -3.996E-13	-2.887E-09
    -1.495		-8.013E-13 -2.915E-09	-2.916E-09 -3.997E-13	-2.916E-09
    -1.521		-8.013E-13 -2.943E-09	-2.944E-09 -3.997E-13	-2.944E-09
    -1.546		-8.013E-13 -2.971E-09	-2.972E-09 -3.997E-13	-2.972E-09
    -1.572		-8.013E-13 -2.999E-09	-2.999E-09 -3.997E-13	-3.000E-09
    -1.598		-8.013E-13 -3.027E-09	-3.027E-09 -3.997E-13	-3.027E-09
    -1.624		-8.013E-13 -3.054E-09	-3.054E-09 -3.997E-13	-3.055E-09
    -1.649		-8.013E-13 -3.082E-09	-3.081E-09 -3.997E-13	-3.082E-09
    -1.675		-8.013E-13 -3.108E-09	-3.109E-09 -3.997E-13	-3.109E-09
    -1.701		-8.013E-13 -3.136E-09	-3.135E-09 -3.997E-13	-3.136E-09
    -1.727		-8.013E-13 -3.162E-09	-3.162E-09 -3.997E-13	-3.163E-09
    -1.753		-8.013E-13 -3.188E-09	-3.188E-09 -3.997E-13	-3.189E-09
    -1.778		-8.013E-13 -3.214E-09	-3.215E-09 -3.997E-13	-3.215E-09
    -1.804		-8.013E-13 -3.241E-09	-3.241E-09 -3.997E-13	-3.241E-09
    -1.830		-8.013E-13 -3.266E-09	-3.267E-09 -3.997E-13	-3.267E-09
    -1.856		-8.013E-13 -3.292E-09	-3.293E-09 -3.997E-13	-3.293E-09
    -1.881		-8.013E-13 -3.317E-09	-3.318E-09 -3.997E-13	-3.318E-09
    -1.907		-8.013E-13 -3.343E-09	-3.343E-09 -3.997E-13	-3.344E-09
    -1.933		-8.013E-13 -3.368E-09	-3.368E-09 -3.997E-13	-3.369E-09
    -1.959		-8.013E-13 -3.393E-09	-3.394E-09 -3.997E-13	-3.394E-09
    -1.985		-8.013E-13 -3.418E-09	-3.418E-09 -3.997E-13	-3.419E-09
    -2.010		-8.013E-13 -3.443E-09	-3.443E-09 -3.997E-13	-3.444E-09
    -2.036		-8.013E-13 -3.468E-09	-3.468E-09 -3.997E-13	-3.468E-09
    -2.062		-8.013E-13 -3.492E-09	-3.492E-09 -3.997E-13	-3.493E-09
    -2.088		-8.013E-13 -3.516E-09	-3.517E-09 -3.997E-13	-3.517E-09
    -2.113		-8.013E-13 -3.540E-09	-3.541E-09 -3.997E-13	-3.541E-09
    -2.139		-8.013E-13 -3.564E-09	-3.565E-09 -3.997E-13	-3.565E-09
    -2.165		-8.013E-13 -3.588E-09	-3.589E-09 -3.997E-13	-3.589E-09
    -2.191		-8.013E-13 -3.612E-09	-3.613E-09 -3.997E-13	-3.613E-09
    -2.216		-8.013E-13 -3.636E-09	-3.636E-09 -3.997E-13	-3.637E-09
    -2.242		-8.013E-13 -3.659E-09	-3.660E-09 -3.997E-13	-3.660E-09
    -2.268		-8.013E-13 -3.682E-09	-3.683E-09 -3.997E-13	-3.683E-09
    -2.294		-8.013E-13 -3.706E-09	-3.706E-09 -3.997E-13	-3.707E-09
    -2.320		-8.013E-13 -3.729E-09	-3.729E-09 -3.997E-13	-3.730E-09
    -2.345		-8.013E-13 -3.752E-09	-3.752E-09 -3.997E-13	-3.753E-09
    -2.371		-8.013E-13 -3.775E-09	-3.775E-09 -3.997E-13	-3.776E-09
    -2.397		-8.013E-13 -3.797E-09	-3.798E-09 -3.997E-13	-3.798E-09
    -2.423		-8.013E-13 -3.820E-09	-3.820E-09 -3.997E-13	-3.821E-09
    -2.448		-8.013E-13 -3.842E-09	-3.843E-09 -3.998E-13	-3.844E-09
    -2.474		-8.013E-13 -3.865E-09	-3.865E-09 -3.998E-13	-3.866E-09
    -2.500		-8.013E-13 -3.887E-09	-3.888E-09 -3.998E-13	-3.888E-09
    -2.526		-8.013E-13 -3.909E-09	-3.910E-09 -3.998E-13	-3.910E-09
    -2.552		-8.013E-13 -3.931E-09	-3.932E-09 -3.998E-13	-3.932E-09
    -2.577		-8.013E-13 -3.954E-09	-3.954E-09 -3.998E-13	-3.954E-09
    -2.603		-8.013E-13 -3.975E-09	-3.976E-09 -3.998E-13	-3.976E-09
    -2.629		-8.013E-13 -3.997E-09	-3.998E-09 -3.998E-13	-3.998E-09
    -2.655		-8.013E-13 -4.019E-09	-4.019E-09 -3.998E-13	-4.019E-09
    -2.680		-8.013E-13 -4.040E-09	-4.041E-09 -3.998E-13	-4.041E-09
    -2.706		-8.013E-13 -4.062E-09	-4.062E-09 -3.998E-13	-4.062E-09
    -2.732		-8.013E-13 -4.083E-09	-4.083E-09 -3.998E-13	-4.084E-09
    -2.758		-8.013E-13 -4.104E-09	-4.105E-09 -3.998E-13	-4.105E-09
    -2.784		-8.013E-13 -4.126E-09	-4.126E-09 -3.998E-13	-4.126E-09
    -2.809		-8.013E-13 -4.147E-09	-4.147E-09 -3.998E-13	-4.147E-09
    -2.835		-8.013E-13 -4.168E-09	-4.168E-09 -3.998E-13	-4.168E-09
    -2.861		-8.013E-13 -4.188E-09	-4.189E-09 -3.998E-13	-4.189E-09
    -2.887		-8.013E-13 -4.209E-09	-4.209E-09 -3.998E-13	-4.210E-09
    -2.912		-8.013E-13 -4.229E-09	-4.230E-09 -3.998E-13	-4.230E-09
    -2.938		-8.013E-13 -4.250E-09	-4.251E-09 -3.998E-13	-4.251E-09
    -2.964		-8.013E-13 -4.271E-09	-4.271E-09 -3.998E-13	-4.271E-09
    -2.990		-8.013E-13 -4.291E-09	-4.291E-09 -3.998E-13	-4.292E-09
    -3.015		-8.013E-13 -4.311E-09	-4.312E-09 -3.998E-13	-4.312E-09
    -3.041		-8.013E-13 -4.332E-09	-4.332E-09 -3.998E-13	-4.332E-09
    -3.067		-8.013E-13 -4.352E-09	-4.352E-09 -3.998E-13	-4.353E-09
    -3.093		-8.013E-13 -4.372E-09	-4.372E-09 -3.998E-13	-4.373E-09
    -3.119		-8.013E-13 -4.391E-09	-4.392E-09 -3.998E-13	-4.392E-09
    -3.144		-8.013E-13 -4.412E-09	-4.412E-09 -3.998E-13	-4.412E-09
    -3.170		-8.013E-13 -4.431E-09	-4.432E-09 -3.998E-13	-4.432E-09
    -3.196		-8.013E-13 -4.451E-09	-4.451E-09 -3.998E-13	-4.452E-09
    -3.222		-8.013E-13 -4.470E-09	-4.471E-09 -3.998E-13	-4.471E-09
    -3.247		-8.013E-13 -4.490E-09	-4.490E-09 -3.998E-13	-4.491E-09
    -3.273		-8.013E-13 -4.509E-09	-4.510E-09 -3.998E-13	-4.510E-09
    -3.299		-8.013E-13 -4.528E-09	-4.529E-09 -3.998E-13	-4.529E-09
    -3.325		-8.013E-13 -4.548E-09	-4.548E-09 -3.998E-13	-4.549E-09
    -3.351		-8.013E-13 -4.567E-09	-4.568E-09 -3.998E-13	-4.568E-09
    -3.376		-8.013E-13 -4.586E-09	-4.587E-09 -3.998E-13	-4.587E-09
    -3.402		-8.013E-13 -4.605E-09	-4.606E-09 -3.998E-13	-4.606E-09
    -3.428		-8.013E-13 -4.624E-09	-4.624E-09 -3.998E-13	-4.625E-09
    -3.454		-8.013E-13 -4.643E-09	-4.643E-09 -3.998E-13	-4.644E-09
    -3.479		-8.013E-13 -4.662E-09	-4.662E-09 -3.998E-13	-4.663E-09
    -3.505		-8.013E-13 -4.680E-09	-4.681E-09 -3.998E-13	-4.681E-09
    -3.531		-8.013E-13 -4.700E-09	-4.699E-09 -3.998E-13	-4.700E-09
    -3.557		-8.013E-13 -4.718E-09	-4.718E-09 -3.998E-13	-4.718E-09
    -3.582		-8.013E-13 -4.736E-09	-4.736E-09 -3.998E-13	-4.737E-09
    -3.608		-8.013E-13 -4.754E-09	-4.755E-09 -3.998E-13	-4.755E-09
    -3.634		-8.013E-13 -4.773E-09	-4.773E-09 -3.998E-13	-4.774E-09
    -3.660		-8.013E-13 -4.791E-09	-4.791E-09 -3.998E-13	-4.791E-09
    -3.686		-8.013E-13 -4.809E-09	-4.809E-09 -3.998E-13	-4.810E-09
    -3.711		-8.013E-13 -4.827E-09	-4.828E-09 -3.998E-13	-4.828E-09
    -3.737		-8.013E-13 -4.845E-09	-4.845E-09 -3.998E-13	-4.845E-09
    -3.763		-8.013E-13 -4.862E-09	-4.863E-09 -3.998E-13	-4.863E-09
    -3.789		-8.013E-13 -4.880E-09	-4.881E-09 -3.998E-13	-4.881E-09
    -3.814		-8.013E-13 -4.898E-09	-4.899E-09 -3.998E-13	-4.899E-09
    -3.840		-8.013E-13 -4.916E-09	-4.916E-09 -3.998E-13	-4.917E-09
    -3.866		-8.013E-13 -4.933E-09	-4.934E-09 -3.998E-13	-4.934E-09
    -3.892		-8.013E-13 -4.950E-09	-4.952E-09 -3.998E-13	-4.952E-09
    -3.918		-8.013E-13 -4.969E-09	-4.968E-09 -3.998E-13	-4.969E-09
    -3.943		-8.013E-13 -4.986E-09	-4.986E-09 -3.998E-13	-4.986E-09
    -3.969		-8.013E-13 -5.003E-09	-5.003E-09 -3.998E-13	-5.004E-09
    -3.995		-8.013E-13 -5.019E-09	-5.020E-09 -3.998E-13	-5.020E-09
    -4.021		-8.013E-13 -5.037E-09	-5.037E-09 -3.998E-13	-5.038E-09
    -4.046		-8.013E-13 -5.053E-09	-5.054E-09 -3.998E-13	-5.054E-09
    -4.072		-8.013E-13 -5.071E-09	-5.071E-09 -3.998E-13	-5.071E-09
    -4.098		-8.013E-13 -5.087E-09	-5.088E-09 -3.998E-13	-5.088E-09
    -4.124		-8.013E-13 -5.104E-09	-5.104E-09 -3.998E-13	-5.105E-09
    -4.149		-8.013E-13 -5.121E-09	-5.121E-09 -3.998E-13	-5.122E-09
    -4.175		-8.013E-13 -5.138E-09	-5.138E-09 -3.998E-13	-5.138E-09
    -4.201		-8.013E-13 -5.153E-09	-5.154E-09 -3.998E-13	-5.154E-09
    -4.227		-8.013E-13 -5.169E-09	-5.170E-09 -3.998E-13	-5.170E-09
    -4.253		-8.013E-13 -5.186E-09	-5.187E-09 -3.998E-13	-5.187E-09
    -4.278		-8.013E-13 -5.203E-09	-5.203E-09 -3.998E-13	-5.203E-09
    -4.304		-8.013E-13 -5.218E-09	-5.219E-09 -3.998E-13	-5.219E-09
    -4.330		-8.013E-13 -5.234E-09	-5.235E-09 -3.998E-13	-5.235E-09
    -4.356		-8.013E-13 -5.250E-09	-5.251E-09 -3.998E-13	-5.251E-09
    -4.381		-8.013E-13 -5.265E-09	-5.266E-09 -3.998E-13	-5.266E-09
    -4.407		-8.013E-13 -5.282E-09	-5.282E-09 -3.998E-13	-5.283E-09
    -4.433		-8.013E-13 -5.297E-09	-5.297E-09 -3.998E-13	-5.298E-09
    -4.459		-8.013E-13 -5.312E-09	-5.313E-09 -3.998E-13	-5.313E-09
    -4.485		-8.013E-13 -5.328E-09	-5.328E-09 -3.998E-13	-5.329E-09
    -4.510		-8.013E-13 -5.343E-09	-5.344E-09 -3.998E-13	-5.344E-09
    -4.536		-8.013E-13 -5.358E-09	-5.359E-09 -3.998E-13	-5.359E-09
    -4.562		-8.013E-13 -5.373E-09	-5.374E-09 -3.998E-13	-5.374E-09
    -4.588		-8.013E-13 -5.389E-09	-5.389E-09 -3.998E-13	-5.389E-09
    -4.613		-8.013E-13 -5.403E-09	-5.404E-09 -3.998E-13	-5.404E-09
    -4.639		-8.013E-13 -5.418E-09	-5.418E-09 -3.998E-13	-5.419E-09
    -4.665		-8.013E-13 -5.432E-09	-5.433E-09 -3.998E-13	-5.433E-09
    -4.691		-8.013E-13 -5.448E-09	-5.448E-09 -3.998E-13	-5.448E-09
    -4.716		-8.013E-13 -5.462E-09	-5.462E-09 -3.998E-13	-5.463E-09
    -4.742		-8.013E-13 -5.476E-09	-5.476E-09 -3.998E-13	-5.477E-09
    -4.768		-8.013E-13 -5.490E-09	-5.490E-09 -3.998E-13	-5.491E-09
    -4.794		-8.013E-13 -5.505E-09	-5.505E-09 -3.998E-13	-5.505E-09
    -4.820		-8.013E-13 -5.518E-09	-5.519E-09 -3.998E-13	-5.519E-09
    -4.845		-8.013E-13 -5.532E-09	-5.533E-09 -3.998E-13	-5.533E-09
    -4.871		-8.013E-13 -5.546E-09	-5.546E-09 -3.998E-13	-5.546E-09
    -4.897		-8.013E-13 -5.560E-09	-5.560E-09 -3.998E-13	-5.560E-09
    -4.923		-8.013E-13 -5.572E-09	-5.573E-09 -3.998E-13	-5.573E-09
    -4.948		-8.013E-13 -5.587E-09	-5.587E-09 -3.998E-13	-5.587E-09
    -4.974		-8.013E-13 -5.600E-09	-5.600E-09 -3.998E-13	-5.601E-09
    -5.000		-8.013E-13 -5.612E-09	-5.613E-09 -3.998E-13	-5.613E-09
    0.026		1.359E-12 5.030E-10	5.034E-10 6.771E-13	5.042E-10
    0.051		5.024E-12 1.535E-09	1.537E-09 2.503E-12	1.540E-09
    0.077		1.490E-11 3.802E-09	3.809E-09 7.424E-12	3.817E-09
    0.103		4.154E-11 9.015E-09	9.036E-09 2.069E-11	9.057E-09
    0.128		1.134E-10 2.132E-08	2.138E-08 5.647E-11	2.143E-08
    0.154		3.070E-10 5.033E-08	5.048E-08 1.529E-10	5.063E-08
    0.179		8.290E-10 1.158E-07	1.162E-07 4.129E-10	1.166E-07
    0.205		2.236E-09 2.495E-07	2.507E-07 1.114E-09	2.518E-07
    0.231		6.030E-09 4.910E-07	4.940E-07 3.005E-09	4.970E-07
    0.256		1.626E-08 8.932E-07	9.013E-07 8.103E-09	9.094E-07
    0.282		4.383E-08 1.551E-06	1.573E-06 2.185E-08	1.595E-06
    0.308		1.182E-07 2.639E-06	2.698E-06 5.891E-08	2.757E-06
    0.333		3.186E-07 4.462E-06	4.622E-06 1.588E-07	4.780E-06
    0.359		8.589E-07 7.563E-06	7.994E-06 4.282E-07	8.422E-06
    0.385		2.315E-06 1.295E-05	1.411E-05 1.154E-06	1.526E-05
    0.410		6.241E-06 2.257E-05	2.570E-05 3.112E-06	2.881E-05
    0.436		1.682E-05 4.045E-05	4.889E-05 8.388E-06	5.728E-05
    0.462		4.533E-05 7.539E-05	9.812E-05 2.260E-05	1.207E-04
    0.487		1.221E-04 1.477E-04	2.089E-04 6.089E-05	2.698E-04
    0.513		3.288E-04 3.066E-04	4.715E-04 1.639E-04	6.354E-04
    0.538		8.845E-04 6.754E-04	1.119E-03 4.410E-04	1.560E-03
    0.564		2.376E-03 1.569E-03	2.760E-03 1.185E-03	3.945E-03
    0.590		6.366E-03 3.804E-03	6.996E-03 3.174E-03	1.017E-02
    0.615		1.699E-02 9.504E-03	1.802E-02 8.474E-03	2.650E-02
    0.641		4.508E-02 2.416E-02	4.676E-02 2.248E-02	6.924E-02
    0.667		1.184E-01 6.178E-02	1.211E-01 5.906E-02	1.802E-01
    0.692		3.063E-01 1.572E-01	3.107E-01 1.528E-01	4.635E-01
    0.718		7.741E-01 3.931E-01	7.811E-01 3.862E-01	1.167E+00
    0.744		1.892E+00 9.547E-01	1.903E+00 9.438E-01	2.846E+00
    0.769		4.415E+00 2.220E+00	4.432E+00 2.203E+00	6.636E+00
    0.795		9.723E+00 4.878E+00	9.748E+00 4.853E+00	1.460E+01
    0.821		2.000E+01 1.002E+01	2.004E+01 9.987E+00	3.002E+01
    0.846		3.826E+01 1.916E+01	3.831E+01 1.911E+01	5.741E+01
    0.872		6.807E+01 3.406E+01	6.814E+01 3.400E+01	1.021E+02
    0.897		1.132E+02 5.663E+01	1.133E+02 5.654E+01	1.698E+02
    0.923		1.772E+02 8.863E+01	1.773E+02 8.852E+01	2.658E+02
    0.949		2.632E+02 1.316E+02	2.633E+02 1.315E+02	3.948E+02
    0.974		3.737E+02 1.869E+02	3.739E+02 1.868E+02	5.607E+02
    1.000		5.110E+02 2.556E+02	5.112E+02 2.554E+02	7.666E+02
    
    Writing J-V to pn_junction_jv.log
    
    Writing mesh and solution to solution_reverse_bias.out
    
    Writing mesh and solution to solution_forward_bias.out



```python
'''
Define doping profile 
Unit of x is microns.
Unit of doping is per cubic centimeter
'''
def doping(x,y):
    if(y<1 and x<10):
        return 1e18
    elif(y<1 and x>30):
        return -1e18
    elif(y>99):
        return -1e18
    else:
        return 1e12
    
''' 
Define node positions and mesh spacing about them as [node position,spacing]
Length unit : microns
'''
nodes_x = [[0,1],[10,0.1],[20,2],[200,4]]
nodes_y = [[0,0.25],[1,0.1],[10,2],[50,4],[90,2],[99,0.1],[100,0.25]]

nodes = [nodes_x,nodes_y]

'''
Define top and bottom boundary conditions as [contact_type,value] where value is potential offset for ohmic and schottky contacts and electric field for normal derivative boundary conditions. Boundary conditions are described for each section. Section is the region between two nodes defined.
'o' - ohmic
's' - schottky
'n' - normal electric field
Potential unit - Volts
Electric field unit - Volts/micron
'''
contact_top = [['n',0],['n',0],['n',0]]
contact_bot = [['n',0],['n',0],['n',0]]

contact = [contact_top,contact_bot]

mesh,Nd,V,n,p = solution_eq_2d(params,nodes,doping,contact,geom='cyl')

plot_solution_2d(mesh,Nd,V,n,p,params,show=True)
```

    Cylindrical structure
    Number of nodes along x-direction = 103
    Number of nodes along y-direction = 67
    Total number of nodes = 6901
    
    Maximum net doping = 1.000000E+18 /cm³
    Minimum net doping = -1.000000E+18 /cm³
    Minimum absolute doping = 1.000000E+12 /cm³
    
    Solution converged for 103 x 67 grid
    Solution converged
    
    Writing mesh and solution to solution.out



    
![png](solver_files/solver_3_1.png)
    



    
![png](solver_files/solver_3_2.png)
    



    
![png](solver_files/solver_3_3.png)
    



    
![png](solver_files/solver_3_4.png)
    



    
![png](solver_files/solver_3_5.png)
    



    
![png](solver_files/solver_3_6.png)
    



    
![png](solver_files/solver_3_7.png)
    

